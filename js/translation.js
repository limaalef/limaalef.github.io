const translations = {
    'pt-BR': {
        title: 'âš½ Minha ColeÃ§Ã£o de Jogos',
        subtitle: 'Me encontre no Telegram @limaalef e no Discord @limaalef',
        football: 'Futebol',
        otherSports: 'Outros esportes',
        games: 'Jogos',
        pending: 'Pendentes',
        future: 'Futuros',
        totalSize: 'Tamanho Total',
        totalDuration: 'DuraÃ§Ã£o Total',
        items: 'Itens:',
        page: 'PÃ¡gina',
        of: 'de',
        auto: 'Auto (5min)',
        allYears: 'Todos os anos',
        search: 'ðŸ” Buscar...',
        cards: 'ðŸŽ´ CartÃµes',
        list: 'ðŸ“‹ Lista',
        loading: 'Carregando jogos...',
        loadingMessage: 'Aguarde enquanto buscamos os dados',
        noMatches: 'Nenhum jogo encontrado',
        noMatchesMessage: 'Tente ajustar os filtros ou realizar uma nova busca',
        date: 'Data',
        competition: 'CompetiÃ§Ã£o',
        phase: 'Fase',
        broadcaster: 'Emissora',
        narration: 'NarraÃ§Ã£o',
        origin: 'Origem',
        location: 'Local',
        homeTeam: 'Mandante',
        awayTeam: 'Visitante',
        duration: 'DuraÃ§Ã£o',
        fileSize: 'Tamanho',
        quality: 'Qualidade',
        bitrate: 'Bitrate',
        audioFormat: 'Formato de Ã¡udio',
        type: 'Tipo',
        cloud: 'Nuvem',
        observations: 'ObservaÃ§Ãµes',
        completed: 'Realizado',
        pendingMatch: 'Pendente',
        futureMatch: 'Futuro',
        loadingData: 'Carregando dados da API...',
        errorLoading: 'Erro ao carregar dados',
        dataUpdated: 'Dados atualizados com sucesso!',
        matchInfo: 'InformaÃ§Ãµes da Partida',
        technicalInfo: 'EspecificaÃ§Ãµes TÃ©cnicas',
        storageInfo: 'Armazenamento',
        errorTitle: 'Erro ao carregar dados',
        errorMessage: 'Verifique a URL da API',
        error: 'Erro',
        loadedText: 'carregados'
    },
    'en': {
        'Copa SÃ£o Paulo de Futebol JÃºnior': 'Under-20 Sao Paulo Cup',
        'Campeonato Carioca': 'Rio Regional Cup',
        'Campeonato Carioca Feminino': "Women's Rio Regional Cup",
        'Campeonato Paulista': 'Sao Paulo Regional Cup',
        'Campeonato Paulista Feminino': "Women's Sao Paulo Regional Cup",
        'Campeonato Brasileiro': 'Brazilian League',
        'Campeonato Brasileiro SÃ©rie B': 'Brazilian Serie B',
        'Campeonato Brasileiro SÃ©rie C': 'Brazilian Serie C',
        'Campeonato Brasileiro Sub-17': 'Under-17 Brazilian League',
        'Campeonato Brasileiro Sub-20': 'Under-20 Brazilian League',
        'Campeonato Brasileiro Feminino': "Women's Brazilian League",
        'Copa do Brasil': 'Brazil Cup',
        'Copa do Brasil Feminina': "Women's Brazil Cup",
        'Supercopa Feminina do Brasil': "Brazilian Women's Super Cup",
        'Supercopa Masculina do Brasil': 'Brazilian Super Cup',
        'Amistoso': "Friendly Match",
        'Amistoso SeleÃ§Ã£o Feminina': "Women's Friendly Match",
        'Amistoso SeleÃ§Ã£o Masculina': "Men's Friendly Match",
        'CONMEBOL Libertadores Feminina': "Women's CONMEBOL Libertadores",
        'Copa Intercontinental Sub-20': 'Under-20 Intercontinental',
        'Copa Intercontinental da FIFA': 'FIFA Intercontinental Cup',
        'Mundial de Clubes FIFA': 'FIFA Club World Cup',
        'Copa do Mundo de Clubes FIFA EUA 2025': '2025 FIFA Club World Cup',
        'Copa do Mundo de Clubes FIFA EUA 2029': '2029 FIFA Club World Cup',
        'Copa do Mundo FIFA de Futebol de Areia Seychelles 2025': '2025 FIFA Beach Soccer World Cup',
        'CONMEBOL Copa AmÃ©rica Feminina': "Women's CONMEBOL Copa AmÃ©rica",
        'CONCACAF Copa Ouro': 'CONCACAF Gold Cup',
        'CONCACAF Copa Ouro Feminina': 'CONCACAF W Gold Cup',
        'EliminatÃ³rias Copa do Mundo FIFA 2014': '2014 FIFA World Cup Qualifiers',
        'EliminatÃ³rias Copa do Mundo FIFA 2018': '2018 FIFA World Cup Qualifiers',
        'EliminatÃ³rias Copa do Mundo FIFA 2022': '2022 FIFA World Cup Qualifiers',
        'EliminatÃ³rias Copa do Mundo FIFA 2026': '2026 FIFA World Cup Qualifiers',
        'EliminatÃ³rias Copa do Mundo FIFA 2030': '2030 FIFA World Cup Qualifiers',
        'Copa do Mundo FIFA EUA 1994': '1994 FIFA World Cup',
        'Copa do Mundo FIFA Coreia do Sul-JapÃ£o 2002': '2022 FIFA World Cup',
        'Copa do Mundo Feminina FiFA AustrÃ¡lia/Nova ZelÃ¢ndia 2023': "2023 FIFA Women's World Cup",
        'Copa do Mundo Feminina FiFA Brasil 2027': "2027 FIFA Women's World Cup",
        'Liga das NaÃ§Ãµes de VÃ´lei': 'FIVB Volleyball Nations League',
        'PrÃ©-OlÃ­mpico de VÃ´lei': ' FIVB Volleyball Olympic Qualification Tournaments',
        'Amistoso Futebol Americano': 'US Football Friendly',
        'Amistoso Rugby': 'Rugby Friendly',
        'Superliga de VÃ´lei': 'Brazilian Volleyball Super League',
        'Copa do Mundo de Rugby': 'Rugby World Cup',
        'Liga Mundial de VÃ´lei': 'FIVB Volleyball World League',
        title: 'âš½ My Football Collection',
        subtitle: 'Contact me on Telegram or Discord @limaalef',
        football: 'Football/Soccer',
        otherSports: 'Other sports',
        games: 'Games',
        pending: 'Pending',
        future: 'Future',
        totalSize: 'Total Size',
        totalDuration: 'Total Duration',
        items: 'Items:',
        page: 'Page',
        of: 'of',
        auto: 'Auto (5min)',
        allYears: 'All years',
        search: 'ðŸ” Search...',
        cards: 'ðŸŽ´ Cards',
        list: 'ðŸ“‹ List',
        loading: 'Loading games...',
        loadingMessage: 'Please wait while we fetch the data',
        noMatches: 'No games found',
        noMatchesMessage: 'Try adjusting the filters or perform a new search',
        date: 'Date',
        competition: 'Competition',
        phase: 'Phase',
        broadcaster: 'Broadcaster',
        narration: 'Commentary',
        origin: 'Origin',
        location: 'Location',
        homeTeam: 'Home Team',
        awayTeam: 'Away Team',
        duration: 'Duration',
        fileSize: 'File Size',
        quality: 'Quality',
        bitrate: 'Bitrate',
        audioFormat: 'Audio Format',
        type: 'Type',
        cloud: 'Cloud',
        observations: 'Observations',
        completed: 'Completed',
        pendingMatch: 'Pending',
        futureMatch: 'Future',
        loadingData: 'Loading data from API...',
        errorLoading: 'Error loading data',
        dataUpdated: 'Data successfully updated!',
        matchInfo: 'Match Information',
        technicalInfo: 'Technical Information',
        storageInfo: 'Storage Information',
        errorTitle: 'Error loading data',
        errorMessage: 'Check the API URL',
        error: 'Error',
        loadedText: 'loaded'
    }
};

const LanguageManager = {
    currentLang: 'pt-BR',

    init() {
        const savedLang = window.appLang || 'pt-BR';
        this.setLanguage(savedLang, false); // false = nÃ£o re-renderizar ainda
        
        document.getElementById('langToggle').addEventListener('click', () => {
            const newLang = this.currentLang === 'pt-BR' ? 'en' : 'pt-BR';
            this.setLanguage(newLang);
        });
    },

    setLanguage(lang, rerender = true) {
        this.currentLang = lang;
        window.appLang = lang;
        document.getElementById('langFlag').textContent = lang === 'pt-BR' ? 'ðŸ‡§ðŸ‡·' : 'ðŸ‡ºðŸ‡¸';
        this.updateAllTexts(rerender);
    },

    t(key) {
        return translations[this.currentLang][key] || key;
    },

    updateAllTexts(rerender = true) {
        // Atualiza elementos com data-i18n
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            const translation = this.t(key);
            
            if (el.tagName === 'INPUT') {
                el.placeholder = translation;
            } else if (el.tagName === 'OPTION') {
                el.textContent = translation;
            } else {
                el.textContent = translation;
            }
        });

        // Atualiza placeholders especiais
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            el.placeholder = this.t(key);
        });

        // Atualiza info de pÃ¡gina
        this.updatePageInfo();

        // Re-renderiza apenas se tiver dados E rerender for true
        if (rerender && window.AppState && AppState.filteredMatches && AppState.filteredMatches.length > 0) {
            if (window.UI && UI.renderMatches) {
                UI.renderMatches();
            }
        }
    },

    updatePageInfo() {
        const pageInfo = document.getElementById('pageInfo');
        if (pageInfo && window.AppState) {
            pageInfo.textContent = `${this.t('page')} ${AppState.currentPage} ${this.t('of')} ${AppState.totalPages}`;
        }
    },

    translateText(text) {
        if (!text) return text;
        
        // Tenta encontrar traduÃ§Ã£o exata
        const translation = this.t(text);
        if (translation !== text) return translation;
        
        // Se nÃ£o encontrar traduÃ§Ã£o exata, tenta traduzir partes conhecidas
        // Exemplo: "28Âª Rodada" -> "28th Round"
        if (this.currentLang === 'en') {
            // Traduz padrÃµes de rodadas
            if (text.includes('Disputa 3Âº Lugar')) {
                return `Play-off for 3rd place`;
            }
            
            let leg = '';
            if (text.includes('Ida')) {
                leg = ' - 1st Leg';
            } else if (text.includes('Volta')) {
                leg = ' - 2nd Leg';
            }

            if (text.includes('Oitavas de Final')) {
                return `Round of 16${leg}`;
            } else if (text.includes('Quartas de Final')) {
                return `Quarterfinals${leg}`;
            } else if (text.includes('Semifinal') || text.includes('Semifinais')) {
                return `Semifinals${leg}`;
            } else if (text.includes('Final')) {
                return `Final${leg}`;
            }

            const roundMatch = text.match(/(\d+)Âª Rodada/);
            if (roundMatch) {
                const number = roundMatch[1];
                const suffix = this.getOrdinalSuffix(number);
                return `Round ${number}`;
            }
        }
        
        return text;
    },
    
    getOrdinalSuffix(num) {
        const n = parseInt(num);
        const s = ["th", "st", "nd", "rd"];
        const v = n % 100;
        return s[(v - 20) % 10] || s[v] || s[0];
    }
};